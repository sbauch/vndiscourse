<script>
  window.assetPath = (function(){

    // TODO: automate this to grab from the manifest, Rails voodoo should be able to get it
    var map = {
      'defer/html-sanitizer-bundle': <%= asset_path('defer/html-sanitizer-bundle.js').inspect.html_safe %>,
      'defer/google_diff_match_patch': <%= asset_path('defer/google_diff_match_patch.js').inspect.html_safe %>
    };

    return function(asset){ return map[asset]; };
  })();
</script>

<script>
  Discourse.CDN = '<%= Rails.configuration.action_controller.asset_host %>';
  Discourse.BaseUrl = '<%= RailsMultisite::ConnectionManagement.current_hostname %>';
  Discourse.BaseUri = '<%= Discourse::base_uri "/" %>';
  Discourse.Environment = '<%= Rails.env %>';
  Discourse.SiteSettings = PreloadStore.get('siteSettings');
  Discourse.Router.map(function() { Discourse.routeBuilder.call(this); });
  Discourse.start()
</script>
